<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Tuesday, December 09, 2008, 2:04 PM -->
<!-- MuClient version 4.37 -->

<!-- Plugin "system_access" generated by Plugin Wizard -->

<muclient>
<plugin
   name="TTS_SystemAccess"
   author="Tyler Spivey"
   id="c97ea1385bf01fd29c866716"
   language="Lua"
   purpose="enables SystemAccess speech"
   save_state="y"
   date_written="2009-11-06 17:00:34"
   requires="4.37"
   version="1.0"
   >

</plugin>

<aliases>
  <alias
   match="tts_stop"
   enabled="y"
   send_to="12"
   sequence="100"
  >
<send>
sa.stop()
</send>
  </alias>
  
  <alias
   match="tts_interrupt *"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>
sa.stop()
sa.say("%1")
</send>
  </alias>
  
<alias
   match="tts_note *"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>
sa.say("%1")
</send>
  </alias>

  <alias
   script="TTSToggle"
   match="tts"
   enabled="y"
   group="TTS"
   omit_from_command_history="y"
   omit_from_log="y"
   omit_from_output="y"
   sequence="100"
  >
  </alias>
  
</aliases>

<script>
<![CDATA[

tts_enabled = true

function OnPluginInstall ()
  assert(package.loadlib("sa.dll", "luaopen_audio"))()
  sa.say("SA plugin initialized")
end

function OnPluginScreendraw(t, log, line)

  AppendToNotepad("output", line .. "\r\n")
  
  if not tts_enabled then
    return
  end --tts off
  
  if t == 0 or   -- output line
     t == 1 then  -- note line
    sa.say(line)
  end -- if
  
end -- function OnPluginScreendraw

function TTSToggle (name, line, wc)

  if tts_enabled then
    tts_enabled = false
    sa.say ("speech off")
  else
    tts_enabled = true
    sa.say ("speech on")
  end -- if
  
end -- function TTSToggle

]]>            
 </script> 
</muclient>
